<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Upload</title>
    <link rel="stylesheet" href="styles_v6.css">
    <!-- Cloudinary Upload Widget -->
    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
</head>
<body>
    <div class="upload-container">
        <h2>Upload Images</h2>
        <label for="image-category">Select Category:</label>
        <select id="image-category" onchange="updateSlotOptions()">
            <option value="services">Services</option>
            <option value="projects">Projects</option>
        </select>

        <label for="image-slot">Select Image Slot:</label>
        <select id="image-slot"></select>

        <button onclick="openUploadWidget()">Upload Image</button>
        <button onclick="clearImages()">Clear All Images</button>
    </div>

    <script>
        // Initialize dropdown options
        function updateSlotOptions() {
            const category = document.getElementById("image-category").value;
            const slotSelect = document.getElementById("image-slot");
            slotSelect.innerHTML = "";

            const slots = 3; // 3 slots for both services and projects
            for (let i = 0; i < slots; i++) {
                const option = document.createElement("option");
                option.value = i;
                option.textContent = Image ${i + 1};
                slotSelect.appendChild(option);
            }
        }

        // Open Cloudinary upload widget
        function openUploadWidget() {
            const category = document.getElementById("image-category").value;
            const slot = document.getElementById("image-slot").value;

            const cloudName = "dujlwpbrv";  // Replace with your Cloudinary cloud name
            const uploadPreset = "isaac092";  // Replace with your upload preset

            const myWidget = cloudinary.createUploadWidget(
                {
                    cloudName: cloudName,
                    uploadPreset: uploadPreset,
                    sources: ["local", "url"],
                    multiple: false,
                    cropping: false,
                    resourceType: "image",
                    maxFileSize: 5000000,
                },
                (error, result) => {
                    if (!error && result && result.event === "success") {
                        const imageUrl = result.info.secure_url;
                        const key = update_${category}_${slot}; // Save with category and slot
                        localStorage.setItem(key, imageUrl);
                        alert("Image uploaded successfully!");
                    } else if (error) {
                        console.error("Upload error:", error);
                        alert("Upload failed. Please try again.");
                    }
                }
            );

            myWidget.open();
        }

        // Clear all images from localStorage
        function clearImages() {
            if (confirm("Are you sure you want to clear all images?")) {
                localStorage.clear();
                alert("All images cleared.");
            }
        }

        // Initialize dropdown options on page load
        document.addEventListener("DOMContentLoaded", function () {
            updateSlotOptions();
        });
    </script>
    <script src="admin.js"></script>
</body>
</html>
